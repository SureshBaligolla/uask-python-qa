{"uid":"3961ce4779b6b66","name":"test_simple_chat_responses[desktop-testdata1]","fullName":"tests.test_chat_validation#test_simple_chat_responses","historyId":"ea3e1ac1c4faea8ae05741ba55c5929e","time":{"start":1761892097885,"stop":1761892162308,"duration":64423},"description":"\n    Validate chatbot responses semantically using OpenAI embeddings.\n    Also validate multilingual behavior: English (LTR) and Arabic (RTL).\n    ","descriptionHtml":"<pre><code>Validate chatbot responses semantically using OpenAI embeddings.\nAlso validate multilingual behavior: English (LTR) and Arabic (RTL).\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: ❌ Similarity too low (0.576) for prompt: Who are you?\nassert 0.576 >= 0.6\n +  where 0.6 = config.SIMILARITY_THRESHOLD_EN","statusTrace":"driver = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"a576f903f6aa10172c5767e0bcf72ef9\")>\ntestdata = {'expected_en': 'I am GovGPT, an AI assistant created to give clear, accurate, and culturally respectful answers to your questions — especially about government operations, Emirati culture, and Islamic values.', 'prompt_en': 'Who are you?'}\n\n    @pytest.mark.parametrize(\"testdata\", json.load(open(\"test_data/test-data.json\", encoding=\"utf-8\")))\n    def test_simple_chat_responses(driver, testdata):\n        \"\"\"\n        Validate chatbot responses semantically using OpenAI embeddings.\n        Also validate multilingual behavior: English (LTR) and Arabic (RTL).\n        \"\"\"\n        login_page = LoginPage(driver)\n        chat_page = ChatPage(driver)\n    \n        # Step 1: Login\n        assert login_page.is_loaded(), \"❌ Login page did not load properly\"\n        login_page.login()\n        assert chat_page.is_ready(), \"❌ Chatbox not ready after login\"\n    \n        # ============================================================\n        # \uD83C\uDF0D ENGLISH TEST\n        # ============================================================\n        prompt_en = testdata.get(\"prompt_en\")\n        expected_en = testdata.get(\"expected_en\")\n    \n        if prompt_en and expected_en:\n            chat_page.send_message(prompt_en)\n            actual_en = chat_page.wait_for_ai_response(timeout=15)\n    \n            similarity_en = openai_validator.calculate_similarity(expected_en, actual_en)\n    \n            print(f\"\\n\uD83C\uDF0D English Prompt: {prompt_en}\")\n            print(f\"Expected: {expected_en}\")\n            print(f\"Actual: {actual_en}\")\n            print(f\"\uD83D\uDD0D Similarity Score: {similarity_en}\")\n    \n            # ✅ Attach English results to Allure report\n            with allure.step(\"Attach English response details\"):\n                allure.attach(prompt_en, name=\"English Prompt\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(expected_en, name=\"Expected English Response\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(actual_en, name=\"Actual English Response\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(str(round(similarity_en, 3)), name=\"English Similarity Score\", attachment_type=allure.attachment_type.TEXT)\n    \n            # ✅ Check layout direction (should be LTR)\n            # direction_en = chat_page.container_direction()\n            # print(f\"\uD83E\uDDED English UI Direction Detected: {direction_en}\")\n            # assert direction_en == \"ltr\", f\"❌ English UI direction mismatch! Found {direction_en}\"\n    \n            # ✅ Semantic validation\n>           assert similarity_en >= config.SIMILARITY_THRESHOLD_EN, (\n                f\"❌ Similarity too low ({similarity_en:.3f}) for prompt: {prompt_en}\"\n            )\nE           AssertionError: ❌ Similarity too low (0.576) for prompt: Who are you?\nE           assert 0.576 >= 0.6\nE            +  where 0.6 = config.SIMILARITY_THRESHOLD_EN\n\ntests/test_chat_validation.py:224: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"driver","time":{"start":1761892083320,"stop":1761892087043,"duration":3723},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"testStage":{"description":"\n    Validate chatbot responses semantically using OpenAI embeddings.\n    Also validate multilingual behavior: English (LTR) and Arabic (RTL).\n    ","status":"failed","statusMessage":"AssertionError: ❌ Similarity too low (0.576) for prompt: Who are you?\nassert 0.576 >= 0.6\n +  where 0.6 = config.SIMILARITY_THRESHOLD_EN","statusTrace":"driver = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"a576f903f6aa10172c5767e0bcf72ef9\")>\ntestdata = {'expected_en': 'I am GovGPT, an AI assistant created to give clear, accurate, and culturally respectful answers to your questions — especially about government operations, Emirati culture, and Islamic values.', 'prompt_en': 'Who are you?'}\n\n    @pytest.mark.parametrize(\"testdata\", json.load(open(\"test_data/test-data.json\", encoding=\"utf-8\")))\n    def test_simple_chat_responses(driver, testdata):\n        \"\"\"\n        Validate chatbot responses semantically using OpenAI embeddings.\n        Also validate multilingual behavior: English (LTR) and Arabic (RTL).\n        \"\"\"\n        login_page = LoginPage(driver)\n        chat_page = ChatPage(driver)\n    \n        # Step 1: Login\n        assert login_page.is_loaded(), \"❌ Login page did not load properly\"\n        login_page.login()\n        assert chat_page.is_ready(), \"❌ Chatbox not ready after login\"\n    \n        # ============================================================\n        # \uD83C\uDF0D ENGLISH TEST\n        # ============================================================\n        prompt_en = testdata.get(\"prompt_en\")\n        expected_en = testdata.get(\"expected_en\")\n    \n        if prompt_en and expected_en:\n            chat_page.send_message(prompt_en)\n            actual_en = chat_page.wait_for_ai_response(timeout=15)\n    \n            similarity_en = openai_validator.calculate_similarity(expected_en, actual_en)\n    \n            print(f\"\\n\uD83C\uDF0D English Prompt: {prompt_en}\")\n            print(f\"Expected: {expected_en}\")\n            print(f\"Actual: {actual_en}\")\n            print(f\"\uD83D\uDD0D Similarity Score: {similarity_en}\")\n    \n            # ✅ Attach English results to Allure report\n            with allure.step(\"Attach English response details\"):\n                allure.attach(prompt_en, name=\"English Prompt\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(expected_en, name=\"Expected English Response\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(actual_en, name=\"Actual English Response\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(str(round(similarity_en, 3)), name=\"English Similarity Score\", attachment_type=allure.attachment_type.TEXT)\n    \n            # ✅ Check layout direction (should be LTR)\n            # direction_en = chat_page.container_direction()\n            # print(f\"\uD83E\uDDED English UI Direction Detected: {direction_en}\")\n            # assert direction_en == \"ltr\", f\"❌ English UI direction mismatch! Found {direction_en}\"\n    \n            # ✅ Semantic validation\n>           assert similarity_en >= config.SIMILARITY_THRESHOLD_EN, (\n                f\"❌ Similarity too low ({similarity_en:.3f}) for prompt: {prompt_en}\"\n            )\nE           AssertionError: ❌ Similarity too low (0.576) for prompt: Who are you?\nE           assert 0.576 >= 0.6\nE            +  where 0.6 = config.SIMILARITY_THRESHOLD_EN\n\ntests/test_chat_validation.py:224: AssertionError","steps":[{"name":"Attach English response details","time":{"start":1761892162306,"stop":1761892162307,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"f21ae23c02049dd1","name":"English Prompt","source":"f21ae23c02049dd1.txt","type":"text/plain","size":12},{"uid":"28d46ea0a0aaabea","name":"Expected English Response","source":"28d46ea0a0aaabea.txt","type":"text/plain","size":194},{"uid":"1d80413de5a47621","name":"Actual English Response","source":"1d80413de5a47621.txt","type":"text/plain","size":167},{"uid":"253f9d07a68b57e9","name":"English Similarity Score","source":"253f9d07a68b57e9.txt","type":"text/plain","size":5}],"parameters":[],"stepsCount":0,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":4}],"attachments":[{"uid":"b3e72620a4587a09","name":"log","source":"b3e72620a4587a09.txt","type":"text/plain","size":227},{"uid":"49e1f5cea4b209e7","name":"stdout","source":"49e1f5cea4b209e7.txt","type":"text/plain","size":2467}],"parameters":[],"stepsCount":1,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":true,"attachmentsCount":6},"afterStages":[{"name":"driver::0","time":{"start":1761892218721,"stop":1761892218764,"duration":43},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_chat_validation"},{"name":"host","value":"Hemanth.local"},{"name":"thread","value":"9597-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_chat_validation"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"driver","value":"'desktop'"},{"name":"testdata","value":"{'prompt_en': 'Who are you?', 'expected_en': 'I am GovGPT, an AI assistant created to give clear, accurate, and culturally respectful answers to your questions — especially about government operations, Emirati culture, and Islamic values.'}"}],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"3961ce4779b6b66.json","parameterValues":["'desktop'","{'prompt_en': 'Who are you?', 'expected_en': 'I am GovGPT, an AI assistant created to give clear, accurate, and culturally respectful answers to your questions — especially about government operations, Emirati culture, and Islamic values.'}"]}